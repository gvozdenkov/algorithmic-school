var se=Object.defineProperty;var ae=(i,t,s)=>t in i?se(i,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[t]=s;var d=(i,t,s)=>(ae(i,typeof t!="symbol"?t+"":t,s),s);import{j as l,r as g,I as E,c as y}from"./index-d20c74ac.js";import{S as re,B as w,s as x,D as p}from"./sleep-06572af7.js";import{u as D,C as k}from"./use-fucus-618f94ac.js";import{T as ne,H as O}from"./element-captions-6dbe28ed.js";const ie=({fill:i="#0032FF"})=>l.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.29289 4.29289C9.68342 3.90237 10.3166 3.90237 10.7071 4.29289L18.4142 12L10.7071 19.7071C10.3166 20.0976 9.68342 20.0976 9.29289 19.7071C8.90237 19.3166 8.90237 18.6834 9.29289 18.2929L15.5858 12L9.29289 5.70711C8.90237 5.31658 8.90237 4.68342 9.29289 4.29289Z",fill:i})}),oe=i=>{switch(i){case"default":return"#0032FF";case"changing":return"#D252E1";case"modified":return"#7FE051"}};class le{constructor(){d(this,"head",null);d(this,"tail",null);d(this,"size",0);d(this,"CreateNode",({value:t,next:s=null,prev:n=null})=>({value:t,next:s,prev:n}));d(this,"isOutOfRangeError",({index:t,max:s,error:n})=>{if(t<0||t>s)throw new Error(n)});d(this,"findNodeByIndex",t=>{if(!this.head||!this.tail||t<0||t>this.size)return;let s=this.head,n=0;for(;n<t;)s=s.next,n++;return s});d(this,"insertAt",(t,s)=>{if(this.isOutOfRangeError({index:t,max:this.size,error:`Can't insert at ${t} index: out of range`}),!this.head||!this.tail){const o=this.CreateNode({value:s});return[this.head,this.tail]=[o,o],this.size++,this.head}if(t===0){const o=this.CreateNode({value:s,next:this.head});return[this.head.prev,this.head]=[o,o],this.size++,this.head}if(t===this.size){const o=this.CreateNode({value:s,prev:this.tail});return[this.tail.next,this.tail]=[o,o],this.size++,this.tail}const n=this.findNodeByIndex(t),r=n.prev,m=this.CreateNode({value:s,next:n,prev:r});return[r.next,n.prev]=[m,m],this.size++,m});d(this,"removeAt",t=>{const s=this.size-1;if(this.isOutOfRangeError({index:t,max:s,error:`Can't remove at ${t} index: out of range`}),!this.head||!this.tail)return null;if(t===0){const o=this.head;return[this.head,this.head.prev]=[this.head.next,null],this.size--,o}if(t===s){const o=this.tail;return[this.tail,this.tail.next]=[this.tail.prev,null],this.size--,o}const n=this.findNodeByIndex(t),r=n.prev,m=n.next;return[r.next,m.prev]=[m,r],this.size--,n});d(this,"removeAll",()=>{this.head=null,this.tail=null,this.size=0});d(this,"prepend",t=>this.insertAt(0,t));d(this,"append",t=>this.insertAt(this.size,t));d(this,"removeHead",()=>this.removeAt(0));d(this,"removeTail",()=>this.removeAt(this.size-1));d(this,"toArray",t=>{if(!this.head||!this.tail)return[];let s=this.head,n;const r=[];if(t)for(;s;)n=t(s),r.push(n),s=s.next;else for(;s;)n=s.value,r.push(n),s=s.next;return r});d(this,"getSize",()=>this.size)}}const de="_form_1masv_1",ue="_form__fieldset_1masv_10",ce="_form__input_1masv_18",he="_form__button_1masv_21",me="_circle_1masv_25",fe="_circle_first_1masv_28",_e="_circle_last_1masv_31",xe="_resultList_1masv_35",pe="_resultList__item_1masv_45",u={form:de,form__fieldset:ue,form__input:ce,form__button:he,circle:me,circle_first:fe,circle_last:_e,resultList:xe,resultList__item:pe},ve=8,ge=4,P=[...Array(ge)].map((i,t)=>t.toString()),Ae=()=>{const[i,t]=g.useState(""),[s,n]=g.useState(""),r=+s,[m,o]=g.useState(P),[f,A]=g.useState(null),[a,v]=g.useState("idle"),[I,j]=g.useState(null),[V,b]=D(),[M,B]=D(),c=g.useRef(new le).current,h=m.length,N=a!=="idle",F=!i||h>=ve,$=F||!s||r>=h,S=!h,Y=S||!s||r>=h;g.useEffect(()=>(P.map(e=>c.append(e)),o(c.toArray()),()=>c.removeAll()),[]);const H=async()=>{for(let e=0;e<=r;e++)A(e),await x(p)},L=async e=>{v("final"),j(e)},T=()=>{v("idle"),A(null),j(null),t(""),n("")},Z=e=>t(e.currentTarget.value),q=e=>e.currentTarget.validity.valid&&n(e.currentTarget.value),G=async()=>{v("addToTail"),await x(p),c.append(i),o(c.toArray()),await L("addToTail"),await x(p),T(),b()},J=async()=>{v("addToHead"),await x(p),c.prepend(i),o(c.toArray()),await L("addToHead"),await x(p),T(),b()},K=async()=>{v("removeFromHead"),await x(p),c.removeHead(),o(c.toArray()),await L("removeFromHead"),T(),B()},Q=async()=>{v("removeFromTail"),await x(p),c.removeTail(),o(c.toArray()),await L("removeFromTail"),T(),B()},U=async()=>{r===h-1?(v("removeFromTail"),A(r),await x(p)):(v("removeByIndex"),await H()),c.removeAt(r),o(c.toArray()),await L("removeByIndex"),await x(p),T(),B()},W=async()=>{v("addByIndex"),await H(),c.insertAt(r,i),o(c.toArray()),await L("addByIndex"),await x(p),T(),b()},C=e=>l.jsx(k,{letter:e,state:"changing",isSmall:!0}),z=e=>a==="addToTail"&&e===h-1?"changing":I==="addToTail"&&a==="final"&&e===h-1?"modified":a==="addToHead"&&e===0?"changing":I==="addToHead"&&a==="final"&&e===0?"modified":I==="removeFromTail"&&a==="removeFromTail"&&e===h-1||a==="addByIndex"&&e<=r&&f!==null&&e<f?"changing":I==="addByIndex"&&a==="final"&&e===r?"modified":a==="removeByIndex"&&e<=r&&f!==null&&e<=f?"changing":"default",X=e=>a==="removeFromTail"&&e===h-1||a==="removeFromHead"&&e===0||a==="removeByIndex"&&e===r&&f!==null&&e===f?"":m[e],ee=e=>a==="removeFromTail"&&e===h-1?C(m[h-1]):a==="removeFromHead"&&e===0?C(m[0]):a==="removeByIndex"&&e===r&&f!==null&&e===f?C(m[r]):e===h-1?ne:null,te=e=>a==="addToTail"&&e===h-1||a==="addToHead"&&e===0?C(i):I==="addToHead"&&a==="final"&&e===0?O:a==="addByIndex"&&e<=r&&f!==null&&e===f?C(i):I==="addByIndex"&&a==="final"&&e!==0?"":e===0&&O;return l.jsxs(re,{title:"Связный список",children:[l.jsxs("form",{className:u.form,children:[l.jsxs("fieldset",{className:u.form__fieldset,disabled:N,children:[l.jsx(E,{value:i,maxLength:4,isLimitText:!0,onChange:Z,disabled:a!=="idle",extraClass:u.form__input,autoComplete:"off",autoFocus:!0,ref:V}),l.jsx(w,{text:"Добавить в head",isLoader:a==="addToHead",disabled:F,type:"button",onClick:J,extraClass:y(u.form__button)}),l.jsx(w,{text:"Добавить в tail",isLoader:a==="addToTail",disabled:F,onClick:G,type:"button",extraClass:y(u.form__button)}),l.jsx(w,{text:"Удалить из head",isLoader:a==="removeFromHead",onClick:K,disabled:S,type:"button",extraClass:y(u.form__button)}),l.jsx(w,{text:"Удалить из tail",isLoader:a==="removeFromTail",onClick:Q,disabled:S,type:"button",extraClass:y(u.form__button)})]}),l.jsxs("fieldset",{className:u.form__fieldset,disabled:N,children:[l.jsx(E,{type:"number",placeholder:"Введите индекс",value:s,min:0,maxLength:h-1,pattern:"\\d+",isLimitText:!0,onChange:q,disabled:a!=="idle",extraClass:u.form__input,autoComplete:"off",autoFocus:!0,ref:M}),l.jsx(w,{text:"Добавить по индексу",isLoader:a==="addByIndex",disabled:$,onClick:W,type:"submit",extraClass:y(u.form__button)}),l.jsx(w,{text:"Удалить по индексу",isLoader:a==="removeByIndex",onClick:U,disabled:Y,type:"button",extraClass:y(u.form__button)})]})]}),l.jsx("ul",{className:y(u.resultList,"mt-24"),children:m.map((e,_)=>{const R=h-1;return l.jsxs("li",{className:u.resultList__item,children:[l.jsx(k,{letter:X(_),index:_,state:z(_),head:te(_),tail:ee(_),extraClass:y(u.circle,{[u.circle_first]:_===0},{[u.circle_last]:_===R})}),_<R&&l.jsx(ie,{fill:oe(z(_))})]},_)})})]})};export{Ae as ListPage};
