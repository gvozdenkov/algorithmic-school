var E=Object.defineProperty;var S=(t,e,a)=>e in t?E(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a;var s=(t,e,a)=>(S(t,typeof e!="symbol"?e+"":e,a),a);import{r as c,j as n,I as z,c as A}from"./index-fef9e21c.js";import{S as D,B as _,s as q,a as L}from"./sleep-2d836259.js";import{u as F,C as I}from"./use-fucus-fee32e23.js";import{T as R,H as N}from"./element-captions-6dbe28ed.js";class P{constructor(e){s(this,"head",0);s(this,"tail",-1);s(this,"length",0);s(this,"size",0);s(this,"queue",[]);s(this,"getLength",()=>this.length);s(this,"getHead",()=>this.head%this.size);s(this,"getTail",()=>this.tail===-1?0:this.tail%this.size);s(this,"isEmpty",()=>this.getLength()===0);s(this,"enqueue",e=>{if(this.length>=this.size)throw new Error("Maximum length exceeded");this.tail=this.tail%this.size===-1?0:this.tail+1,this.queue[this.tail%this.size]=e,this.length++});s(this,"dequeue",()=>{if(this.isEmpty())throw new Error("No elements in the queue");this.queue[this.head%this.size]=void 0,this.length--,this.head=this.length?this.head+1:0,this.tail=this.length?this.tail:-1});s(this,"peak",()=>{if(this.isEmpty())throw new Error("No elements in the queue");return this.queue[this.head]});s(this,"getQueue",()=>this.queue);s(this,"clearQueue",()=>{this.queue=[...Array(this.size)],this.head=0,this.tail=-1,this.length=0});this.size=e,this.queue=[...Array(e)]}}const k=t=>(e,a)=>e==="addToTail"&&a===t.getTail()||e==="removeFromHead"&&a===t.getHead()?"changing":"default",M=t=>e=>e===t.getTail()&&t.getLength()>0&&R,V=t=>e=>e===t.getHead()&&t.getLength()>0&&N,$="_form_1wn8q_1",O="_form__input_1wn8q_11",Y="_resultList_1wn8q_16",G="_clearBtn_1wn8q_25",J="_addBtn_1wn8q_29",K="_deleteBtn_1wn8q_33",r={form:$,form__input:O,resultList:Y,clearBtn:G,addBtn:J,deleteBtn:K},p=7,B=[...Array(p)],se=()=>{const[t,e]=c.useState(""),[a,l]=c.useState(B),[h,d]=c.useState("idle"),[T,g]=F(),i=c.useRef(new P(p)).current,f=i.getLength(),m=h!=="idle",w=m||f>=p||!t,x=m||!f,C=k(i),Q=V(i),b=M(i),j=u=>{e(u.currentTarget.value)},H=()=>{i.clearQueue(),l(B),e(""),g()},v=async u=>{u.preventDefault(),d("addToTail"),i.enqueue(t),l(i.getQueue()),e(""),await q(L),d("idle"),g()},y=async()=>{d("removeFromHead"),l(i.getQueue()),await q(L),i.dequeue(),l(i.getQueue()),d("idle"),g()};return n.jsxs(D,{title:"Очередь",children:[n.jsxs("form",{className:r.form,onSubmit:u=>void v(u),children:[n.jsx(z,{value:t,maxLength:4,isLimitText:!0,onChange:j,disabled:m,extraClass:r.form__input,autoComplete:"off",ref:T,autoFocus:!0,"data-test":"input"}),n.jsx(_,{type:"submit",text:"Добавить",isLoader:h==="addToTail",disabled:w,extraClass:r.addBtn,"data-test":"add-btn"}),n.jsx(_,{text:"Удалить",onClick:()=>void y(),isLoader:h==="removeFromHead",disabled:x,extraClass:r.deleteBtn,"data-test":"remove-btn"}),n.jsx(_,{text:"Очистить",onClick:H,disabled:x,extraClass:r.clearBtn,"data-test":"clear-btn"})]}),n.jsx("ul",{className:A(r.resultList),children:a.map((u,o)=>n.jsx("li",{children:n.jsx(I,{letter:u,index:o,state:C(h,o),head:Q(o),tail:b(o),"data-test":`circle-${o}`})},o))})]})};export{se as QueuePage};
