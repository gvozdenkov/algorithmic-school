var re=Object.defineProperty;var se=(i,t,r)=>t in i?re(i,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[t]=r;var _=(i,t,r)=>(se(i,typeof t!="symbol"?t+"":t,r),r);import{j as l,r as b,c as h,I as R}from"./index-298ce0e6.js";import{S as ne,B as C,s as x,D as y}from"./sleep-20444c3a.js";import{T as oe,H as E}from"./element-captions-6dbe28ed.js";import{u as V,C as D}from"./use-fucus-6086a647.js";const ae=({fill:i="#0032FF"})=>l.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.29289 4.29289C9.68342 3.90237 10.3166 3.90237 10.7071 4.29289L18.4142 12L10.7071 19.7071C10.3166 20.0976 9.68342 20.0976 9.29289 19.7071C8.90237 19.3166 8.90237 18.6834 9.29289 18.2929L15.5858 12L9.29289 5.70711C8.90237 5.31658 8.90237 4.68342 9.29289 4.29289Z",fill:i})}),ie=i=>{switch(i){case"default":return"#7a7a7a";case"changing":return"#e0bc72";case"modified":return"#7cbe5d"}};class de{constructor(){_(this,"head",null);_(this,"tail",null);_(this,"size",0);_(this,"CreateNode",({value:t,next:r=null,prev:a=null})=>({value:t,next:r,prev:a}));_(this,"isOutOfRangeError",({index:t,max:r,error:a})=>{if(t<0||t>r)throw new Error(a)});_(this,"findNodeByIndex",t=>{if(!this.head||!this.tail||t<0||t>this.size)return;let r=this.head,a=0;for(;a<t;)r=r.next,a++;return r});_(this,"insertAt",(t,r)=>{if(this.isOutOfRangeError({index:t,max:this.size,error:`Can't insert at ${t} index: out of range`}),!this.head||!this.tail){const d=this.CreateNode({value:r});return[this.head,this.tail]=[d,d],this.size++,this.head}if(t===0){const d=this.CreateNode({value:r,next:this.head});return[this.head.prev,this.head]=[d,d],this.size++,this.head}if(t===this.size){const d=this.CreateNode({value:r,prev:this.tail});return[this.tail.next,this.tail]=[d,d],this.size++,this.tail}const a=this.findNodeByIndex(t),o=a.prev,f=this.CreateNode({value:r,next:a,prev:o});return[o.next,a.prev]=[f,f],this.size++,f});_(this,"removeAt",t=>{const r=this.size-1;if(this.isOutOfRangeError({index:t,max:r,error:`Can't remove at ${t} index: out of range`}),!this.head||!this.tail)return null;if(t===0){const d=this.head;return[this.head,this.head.prev]=[this.head.next,null],this.size--,d}if(t===r){const d=this.tail;return[this.tail,this.tail.next]=[this.tail.prev,null],this.size--,d}const a=this.findNodeByIndex(t),o=a.prev,f=a.next;return[o.next,f.prev]=[f,o],this.size--,a});_(this,"removeAll",()=>{this.head=null,this.tail=null,this.size=0});_(this,"prepend",t=>this.insertAt(0,t));_(this,"append",t=>this.insertAt(this.size,t));_(this,"removeHead",()=>this.removeAt(0));_(this,"removeTail",()=>this.removeAt(this.size-1));_(this,"toArray",t=>{if(!this.head||!this.tail)return[];let r=this.head,a;const o=[];if(t)for(;r;)a=t(r),o.push(a),r=r.next;else for(;r;)a=r.value,o.push(a),r=r.next;return o});_(this,"getSize",()=>this.size)}}const le="_form_jcoke_1",_e="_form__fieldset_jcoke_10",ue="_form__fieldset_type_byValue_jcoke_15",ce="_form__fieldset_type_byIndex_jcoke_21",me="_form__input_jcoke_27",fe="_form__input_type_value_jcoke_30",he="_form__input_type_index_jcoke_33",pe="_circle_jcoke_55",xe="_circle_first_jcoke_58",ye="_circle_last_jcoke_61",n={form:le,form__fieldset:_e,form__fieldset_type_byValue:ue,form__fieldset_type_byIndex:ce,form__input:me,form__input_type_value:fe,form__input_type_index:he,"form__button_type_add-to-head":"_form__button_type_add-to-head_jcoke_36","form__button_type_add-to-tail":"_form__button_type_add-to-tail_jcoke_39","form__button_type_remove-from-tail":"_form__button_type_remove-from-tail_jcoke_42","form__button_type_remove-from-head":"_form__button_type_remove-from-head_jcoke_45","form__button_type_add-by-index":"_form__button_type_add-by-index_jcoke_48","form__button_type_remove-by-index":"_form__button_type_remove-by-index_jcoke_51",circle:pe,circle_first:xe,circle_last:ye,"result-list":"_result-list_jcoke_65","result-list__item":"_result-list__item_jcoke_75"},ve=8,be=4,O=[...Array(be)].map((i,t)=>t.toString()),Ae=()=>{const[i,t]=b.useState(""),[r,a]=b.useState(""),o=+r,[f,d]=b.useState(O),[p,B]=b.useState(null),[s,v]=b.useState("idle"),[g,S]=b.useState(null),[P,A]=V(),[$,L]=V(),u=b.useRef(new de).current,c=f.length,F=s!=="idle",k=!i||c>=ve,M=k||!r||o>=c,w=!c,Y=w||!r||o>=c;b.useEffect(()=>(O.map(e=>u.append(e)),d(u.toArray()),()=>u.removeAll()),[]);const N=async()=>{for(let e=0;e<=o;e++)B(e),await x(y)},I=e=>{v("final"),S(e)},T=()=>{v("idle"),B(null),S(null),t(""),a("")},Z=e=>t(e.currentTarget.value),q=e=>e.currentTarget.validity.valid&&a(e.currentTarget.value),G=async()=>{v("addToTail"),await x(y),u.append(i),d(u.toArray()),I("addToTail"),await x(y),T(),A()},J=async()=>{v("addToHead"),await x(y),u.prepend(i),d(u.toArray()),I("addToHead"),await x(y),T(),A()},K=async()=>{v("removeFromHead"),await x(y),u.removeHead(),d(u.toArray()),I("removeFromHead"),T(),L()},Q=async()=>{v("removeFromTail"),await x(y),u.removeTail(),d(u.toArray()),I("removeFromTail"),T(),L()},U=async()=>{o===c-1?(v("removeFromTail"),B(o),await x(y)):(v("removeByIndex"),await N()),u.removeAt(o),d(u.toArray()),I("removeByIndex"),await x(y),T(),L()},W=async()=>{v("addByIndex"),await N(),u.insertAt(o,i),d(u.toArray()),I("addByIndex"),await x(y),T(),A()},j=(e,m)=>l.jsx(D,{letter:e,state:"changing",isSmall:!0,"data-test":`circle-${m}`}),H=e=>s==="addToTail"&&e===c-1?"changing":g==="addToTail"&&s==="final"&&e===c-1?"modified":s==="addToHead"&&e===0?"changing":g==="addToHead"&&s==="final"&&e===0?"modified":g==="removeFromTail"&&s==="removeFromTail"&&e===c-1||s==="addByIndex"&&e<=o&&p!==null&&e<p?"changing":g==="addByIndex"&&s==="final"&&e===o?"modified":s==="removeByIndex"&&e<=o&&p!==null&&e<=p?"changing":"default",X=e=>s==="removeFromTail"&&e===c-1||s==="removeFromHead"&&e===0||s==="removeByIndex"&&e===o&&p!==null&&e===p?"":f[e],ee=e=>s==="removeFromTail"&&e===c-1?j(f[c-1]):s==="removeFromHead"&&e===0?j(f[0]):s==="removeByIndex"&&e===o&&p!==null&&e===p?j(f[o],"tail"):e===c-1?oe:null,te=e=>s==="addToTail"&&e===c-1||s==="addToHead"&&e===0?j(i):g==="addToHead"&&s==="final"&&e===0?E:s==="addByIndex"&&e<=o&&p!==null&&e===p?j(i,"head"):g==="addByIndex"&&s==="final"&&e!==0?"":e===0&&E;return l.jsxs(ne,{title:"Связный список",children:[l.jsxs("form",{className:n.form,children:[l.jsxs("fieldset",{className:h(n.form__fieldset,n.form__fieldset_type_byValue),disabled:F,children:[l.jsx(R,{value:i,maxLength:4,isLimitText:!0,onChange:Z,disabled:s!=="idle",extraClass:h(n.form__input,n.form__input_type_value),autoComplete:"off",autoFocus:!0,ref:P,"data-test":"inputValue"}),l.jsx(C,{text:"Добавить в head",isLoader:s==="addToHead",disabled:k,onClick:()=>void J(),extraClass:h(n.form__button,n["form__button_type_add-to-head"]),"data-test":"addHeadBtn"}),l.jsx(C,{text:"Добавить в tail",isLoader:s==="addToTail",disabled:k,onClick:()=>void G(),extraClass:h(n.form__button,n["form__button_type_add-to-tail"]),"data-test":"addTailBtn"}),l.jsx(C,{text:"Удалить из head",isLoader:s==="removeFromHead",onClick:()=>void K(),disabled:w,extraClass:h(n.form__button,n["form__button_type_remove-from-head"]),"data-test":"removeHeadBtn"}),l.jsx(C,{text:"Удалить из tail",isLoader:s==="removeFromTail",onClick:()=>void Q(),disabled:w,extraClass:h(n.form__button,n["form__button_type_remove-from-tail"]),"data-test":"removeTailBtn"})]}),l.jsxs("fieldset",{className:h(n.form__fieldset,n.form__fieldset_type_byIndex),disabled:F,children:[l.jsx(R,{type:"number",placeholder:"Введите индекс",value:r,min:0,maxLength:c-1,pattern:"\\d+",isLimitText:!0,onChange:q,disabled:s!=="idle",extraClass:h(n.form__input,n.form__input_type_index),autoComplete:"off",autoFocus:!0,ref:$,"data-test":"inputIndex"}),l.jsx(C,{text:"Добавить по индексу",isLoader:s==="addByIndex",disabled:M,onClick:()=>void W(),extraClass:h(n.form__button,n["form__button_type_add-by-index"]),"data-test":"addByIndexBtn"}),l.jsx(C,{text:"Удалить по индексу",isLoader:s==="removeByIndex",onClick:()=>void U(),disabled:Y,extraClass:h(n.form__button,n["form__button_type_remove-by-index"]),"data-test":"removeByIndexBtn"})]})]}),l.jsx("ul",{className:h(n["result-list"],"mt-24"),children:f.map((e,m)=>{const z=c-1;return l.jsxs("li",{className:n["result-list__item"],children:[m>0&&m<=z&&l.jsx(ae,{fill:ie(H(m))}),l.jsx(D,{letter:X(m),index:m,state:H(m),head:te(m),tail:ee(m),extraClass:h(n.circle,{[n.circle_first]:m===0},{[n.circle_last]:m===z}),"data-test":`circle-${m}`})]},m)})})]})};export{Ae as ListPage};
